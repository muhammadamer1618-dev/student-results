<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>شهادة الطالب</title>

<link href='https://fonts.googleapis.com/css2?family=Calibri:wght@400;700&display=swap' rel='stylesheet'>

<style>
body{font-family:Calibri;background:#f2f6fa;margin:0}
header{background:#1976d2;color:white;padding:20px;text-align:center;font-size:24px}
.container{padding:25px}
input{width:100%;padding:15px;font-size:18px;border-radius:8px;border:1px solid #999;margin-bottom:15px}
button{width:100%;padding:16px;background:#1976d2;color:white;border:none;border-radius:8px;font-size:18px;margin-bottom:10px}

#cert{
    background:white;
    border:6px double gold;
    padding:25px;
    border-radius:12px;
    display:none;
    margin-top:20px
}

table{
    width:100%;
    border-collapse:collapse;
    margin-top:15px
}

td{
    border:1px solid #d0d0d0;
    padding:12px;
    font-size:20px
}

.label{color:#c62828;font-weight:bold;width:35%}
.value{color:#1565c0}

.row2{
    display:flex;
    justify-content:space-between;
    margin-top:15px;
}

.box{
    width:48%;
    border:1px solid #d0d0d0;
    padding:12px;
    font-size:20px;
    border-radius:8px;
}

@media print{
    header,button,input{display:none}
    body{background:white}
}
</style>
</head>

<body>

<header>شهادة الطالب</header>

<div class="container">

<input id="code" placeholder="ادخل كود الطالب">
<button onclick="loadData()">عرض</button>
<button onclick='window.print()'>طباعة</button>
<button onclick="location='index.html'">رجوع</button>

<div id="cert">

<h2 style="text-align:center;color:#1565c0;margin-bottom:10px">مدرسة الفلاح الأهليه</h2>
<h3 style="text-align:center;margin-bottom:25px">شهادة طالب</h3>

<!-- السطر الأول: الاسم والصف -->
<div class="row2">
    <div class="box"><span class="label">اسم الطالب: </span><span class="value" id="student_name"></span></div>
    <div class="box"><span class="label">الصف: </span><span class="value" id="grade"></span></div>
</div>

<!-- السطر الثاني: المرحلة والمادة -->
<div class="row2">
    <div class="box"><span class="label">المرحلة: </span><span class="value" id="stage"></span></div>
    <div class="box"><span class="label">المادة: </span><span class="value" id="s_subject"></span></div>
</div>

<!-- الدرجات -->
<table>
<tr><td class="label">الدرجة النهائية:</td><td class="value" id="fullMark"></td></tr>
<tr><td class="label">درجة الطالب:</td><td class="value" id="mark"></td></tr>
<tr><td class="label">التقدير:</td><td class="value" id="rating"></td></tr>
<tr><td class="label">اسم المعلم:</td><td class="value" id="teacher"></td></tr>
</table>

<br>

<!-- بيانات الإدارة -->
<table>
<tr><td class="label">المشرف:</td><td class="value" id="s_supervisor"></td></tr>
<tr><td class="label">رئيس قسم الإشراف:</td><td class="value" id="s_head"></td></tr>
<tr><td class="label">مدير المدرسة:</td><td class="value" id="s_principal"></td></tr>
</table>

</div>
</div>

<script>
function getS(){
    let s = localStorage.getItem('schoolSettings');
    if(!s){
        s = {
            subject: "لغة انجليزية",
            supervisor: "محمد عامر أحمد",
            head: "أحمد سمير عباس",
            principal: "سعيد بن علي الجمعان"
        };
        localStorage.setItem('schoolSettings', JSON.stringify(s));
    }
    return JSON.parse(s);
}

function calcRating(mark, full){
    let p = (mark / full) * 100;

    if(p >= 90) return "ممتاز";
    if(p >= 80) return "جيد جدًا";
    if(p >= 70) return "جيد";
    if(p >= 60) return "مقبول";
    return "ضعيف";
}

function loadData(){
    const codeInput = document.getElementById("code").value.trim();
    let all = localStorage.getItem('students');

    if(!all){
        alert("لا توجد بيانات");
        return;
    }

    all = JSON.parse(all);

    if(!all[codeInput]){
        alert("لا يوجد طالب بهذا الكود");
        return;
    }

    const st = all[codeInput];
    const s  = getS();
    const cert = document.getElementById("cert");
    cert.style.display = "block";

    document.getElementById("s_subject").innerText    = s.subject;
    document.getElementById("s_supervisor").innerText = s.supervisor;
    document.getElementById("s_head").innerText       = s.head;
    document.getElementById("s_principal").innerText  = s.principal;

    document.getElementById("student_name").innerText = st.name;
    document.getElementById("stage").innerText        = st.stage;
    document.getElementById("grade").innerText        = st.grade;
    document.getElementById("fullMark").innerText     = st.fullMark;
    document.getElementById("mark").innerText         = st.mark;
    document.getElementById("teacher").innerText      = st.teacher;

    // حساب التقدير
    let rating = calcRating(Number(st.mark), Number(st.fullMark));
    document.getElementById("rating").innerText = rating;
}
</script>

</body>
</html>
